Table tennis ranking ¬∑ HTML
Copy

<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞–Ω–≥–ª–∏—Å—Ç–∞ –¢–µ–Ω–∏—Å –Ω–∞ –ú–∞—Å–∞</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            overflow-x: auto;
        }
        
        .nav-tab {
            padding: 15px 30px;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 16px;
            font-weight: 500;
            color: #495057;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .nav-tab:hover {
            background: #e9ecef;
        }
        
        .nav-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }
        
        .content {
            padding: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .ranking-position {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .ranking-gold {
            color: #FFD700;
        }
        
        .ranking-silver {
            color: #C0C0C0;
        }
        
        .ranking-bronze {
            color: #CD7F32;
        }
        
        .search-filter {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .card h3 {
            margin-bottom: 15px;
            color: #667eea;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .match-result {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .player-info {
            flex: 1;
            text-align: center;
        }
        
        .vs-separator {
            padding: 0 20px;
            font-weight: bold;
            color: #667eea;
        }
        
        .points-change {
            font-weight: bold;
            margin-top: 5px;
        }
        
        .points-gain {
            color: #28a745;
        }
        
        .points-loss {
            color: #dc3545;
        }
        
        .month-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .month-selector button {
            padding: 8px 15px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card h4 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .stat-card p {
            font-size: 2em;
            font-weight: bold;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
        }

        .export-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .login-modal {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 90%;
        }

        .login-modal h2 {
            color: #667eea;
            margin-bottom: 10px;
            text-align: center;
        }

        .login-modal p {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }

        .login-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .admin-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-left: 15px;
        }

        .guest-badge {
            background: #6c757d;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-left: 15px;
        }

        .header-actions {
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-container {
            position: relative;
        }

        .welcome-text {
            font-size: 0.9em;
            opacity: 0.95;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Utility functions
        const generateId = () => '_' + Math.random().toString(36).substr(2, 9);
        
        const getCurrentMonth = () => {
            const now = new Date();
            return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
        };

        const getAgeGroup = (dateOfBirth, gender) => {
            const today = new Date();
            const birth = new Date(dateOfBirth);
            const age = today.getFullYear() - birth.getFullYear();
            
            if (gender === '–ú—ä–∂') {
                if (age <= 11) return '–ú–æ–º—á–µ—Ç–∞ –¥–æ 11–≥.';
                if (age <= 13) return '–ú–∏–Ω–∏–ö–∞–¥–µ—Ç–∏';
                if (age <= 15) return '–ö–∞–¥–µ—Ç–∏';
                if (age <= 18) return '–Æ–Ω–æ—à–∏ –°—Ç–∞—Ä—à–∞ –≤—ä–∑—Ä–∞—Å—Ç';
                if (age <= 21) return '–ú–ª–∞–¥–µ–∂–∏ –¥–æ 21–≥.';
                return '–ú—ä–∂–µ';
            } else {
                if (age <= 11) return '–ú–æ–º–∏—á–µ—Ç–∞ –¥–æ 11–≥.';
                if (age <= 13) return '–ú–∏–Ω–∏ –ö–∞–¥–µ—Ç–∫–∏';
                if (age <= 15) return '–ö–∞–¥–µ—Ç–∫–∏';
                if (age <= 18) return '–î–µ–≤–æ–π–∫–∏ –°—Ç–∞—Ä—à–∞ –í—ä–∑—Ä–∞—Å—Ç';
                if (age <= 21) return '–î–µ–≤–æ–π–∫–∏ –¥–æ 21–≥.';
                return '–ñ–µ–Ω–∏';
            }
        };

        const calculatePointsChange = (winnerPoints, loserPoints, isWinnerStronger) => {
            const diff = Math.abs(winnerPoints - loserPoints);
            
            let pointsChange = 0;
            
            if (diff <= 24) pointsChange = 6;
            else if (diff <= 49) pointsChange = 7;
            else if (diff <= 99) pointsChange = 8;
            else if (diff <= 149) pointsChange = 10;
            else if (diff <= 199) pointsChange = 13;
            else if (diff <= 299) pointsChange = 17;
            else if (diff <= 399) pointsChange = 22;
            else if (diff <= 499) pointsChange = 28;
            else pointsChange = 40;
            
            // If winner is stronger (more points), they gain less points (Logique)
            if (isWinnerStronger) {
                if (diff <= 24) return { winner: 6, loser: -6 };
                else if (diff <= 49) return { winner: 5, loser: -5 };
                else if (diff <= 99) return { winner: 4, loser: -4 };
                else if (diff <= 149) return { winner: 3, loser: -3 };
                else if (diff <= 199) return { winner: 2, loser: -2 };
                else if (diff <= 299) return { winner: 1, loser: -1 };
                else if (diff <= 399) return { winner: 0.5, loser: -0.5 };
                else return { winner: 0, loser: 0 };
            } else {
                // Winner is weaker (Performance/Perf)
                return { winner: pointsChange, loser: -pointsChange };
            }
        };

        function App() {
            const [activeTab, setActiveTab] = useState('ranking');
            const [currentMonth, setCurrentMonth] = useState(getCurrentMonth());
            
            // Authentication states
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [isAdmin, setIsAdmin] = useState(false);
            const [loginForm, setLoginForm] = useState({ username: '', password: '' });
            const [showLogin, setShowLogin] = useState(false);
            
            // Data states
            const [players, setPlayers] = useState([]);
            const [clubs, setClubs] = useState([]);
            const [tournaments, setTournaments] = useState([]);
            const [matches, setMatches] = useState([]);
            const [monthlyRankings, setMonthlyRankings] = useState({});
            
            // Form states
            const [playerForm, setPlayerForm] = useState({
                firstName: '', lastName: '', dateOfBirth: '', gender: '–ú—ä–∂',
                clubId: '', licenseNumber: '', initialPoints: 500
            });
            
            const [clubForm, setClubForm] = useState({
                name: '', city: '', clubNumber: ''
            });
            
            const [tournamentForm, setTournamentForm] = useState({
                name: '', startDate: '', endDate: '', location: '', hostClubId: '', coefficient: 1.0
            });
            
            const [matchForm, setMatchForm] = useState({
                tournamentId: '', player1Id: '', player2Id: '', 
                format: 'best-of-5', winnerId: '', score: ''
            });
            
            // Filter states
            const [searchTerm, setSearchTerm] = useState('');
            const [filterClub, setFilterClub] = useState('');
            const [filterAgeGroup, setFilterAgeGroup] = useState('');
            
            const [alert, setAlert] = useState(null);
            const [editingPlayer, setEditingPlayer] = useState(null);
            const [editingClub, setEditingClub] = useState(null);
            const [editingTournament, setEditingTournament] = useState(null);

            // Load data from localStorage
            useEffect(() => {
                // First check for automatic backup
                const autoBackup = localStorage.getItem('tt_auto_backup');
                const backupTimestamp = localStorage.getItem('tt_backup_timestamp');
                
                let hasData = false;
                const savedPlayers = localStorage.getItem('tt_players');
                const savedClubs = localStorage.getItem('tt_clubs');
                const savedTournaments = localStorage.getItem('tt_tournaments');
                const savedMatches = localStorage.getItem('tt_matches');
                const savedRankings = localStorage.getItem('tt_monthly_rankings');
                
                // Check if we have any data in current storage
                hasData = savedPlayers || savedClubs || savedTournaments || savedMatches || savedRankings;
                
                // If we have a backup but no current data, offer to restore
                if (autoBackup && !hasData) {
                    const backup = JSON.parse(autoBackup);
                    const backupDate = backupTimestamp ? new Date(backupTimestamp).toLocaleString('bg-BG') : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ –¥–∞—Ç–∞';
                    
                    if (window.confirm(`–û—Ç–∫—Ä–∏—Ç –µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω backup –æ—Ç ${backupDate}.\n\n–ò—Å–∫–∞—Ç–µ –ª–∏ –¥–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω–∏—Ç–µ?\n\n–°—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–∏: ${backup.players?.length || 0}\n–ö–ª—É–±–æ–≤–µ: ${backup.clubs?.length || 0}\n–¢—É—Ä–Ω–∏—Ä–∏: ${backup.tournaments?.length || 0}\n–ú–∞—á–æ–≤–µ: ${backup.matches?.length || 0}`)) {
                        setPlayers(backup.players || []);
                        setClubs(backup.clubs || []);
                        setTournaments(backup.tournaments || []);
                        setMatches(backup.matches || []);
                        setMonthlyRankings(backup.monthlyRankings || {});
                        showAlert('–î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ —É—Å–ø–µ—à–Ω–æ –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—è backup!', 'success');
                    }
                } else {
                    // Load normally
                    if (savedPlayers) setPlayers(JSON.parse(savedPlayers));
                    if (savedClubs) setClubs(JSON.parse(savedClubs));
                    if (savedTournaments) setTournaments(JSON.parse(savedTournaments));
                    if (savedMatches) setMatches(JSON.parse(savedMatches));
                    if (savedRankings) setMonthlyRankings(JSON.parse(savedRankings));
                }
                
                const savedAuth = localStorage.getItem('tt_is_admin');
                
                // Check if user was logged in as admin
                if (savedAuth === 'true') {
                    setIsAdmin(true);
                    setIsAuthenticated(true);
                }
            }, []);

            // Save data to localStorage
            useEffect(() => {
                localStorage.setItem('tt_players', JSON.stringify(players));
                createAutoBackup();
            }, [players]);

            useEffect(() => {
                localStorage.setItem('tt_clubs', JSON.stringify(clubs));
                createAutoBackup();
            }, [clubs]);

            useEffect(() => {
                localStorage.setItem('tt_tournaments', JSON.stringify(tournaments));
                createAutoBackup();
            }, [tournaments]);

            useEffect(() => {
                localStorage.setItem('tt_matches', JSON.stringify(matches));
                createAutoBackup();
            }, [matches]);

            useEffect(() => {
                localStorage.setItem('tt_monthly_rankings', JSON.stringify(monthlyRankings));
                createAutoBackup();
            }, [monthlyRankings]);

            // Create automatic backup of all data
            const createAutoBackup = () => {
                try {
                    const backup = {
                        players,
                        clubs,
                        tournaments,
                        matches,
                        monthlyRankings,
                        version: '1.0',
                        timestamp: new Date().toISOString()
                    };
                    localStorage.setItem('tt_auto_backup', JSON.stringify(backup));
                    localStorage.setItem('tt_backup_timestamp', new Date().toISOString());
                } catch (error) {
                    console.error('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω backup:', error);
                }
            };

            const showAlert = (message, type = 'success') => {
                setAlert({ message, type });
                setTimeout(() => setAlert(null), 3000);
            };

            // Authentication functions
            const handleLogin = () => {
                if (loginForm.username === 'admin' && loginForm.password === 'TT#Rank2026!vK$92mPx') {
                    setIsAdmin(true);
                    setIsAuthenticated(true);
                    localStorage.setItem('tt_is_admin', 'true');
                    setShowLogin(false);
                    showAlert('–£—Å–ø–µ—à–Ω–æ –≤–ª—è–∑–æ—Ö—Ç–µ –∫–∞—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!');
                    setLoginForm({ username: '', password: '' });
                } else {
                    showAlert('–ì—Ä–µ—à–Ω–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ –∏–ª–∏ –ø–∞—Ä–æ–ª–∞!', 'error');
                }
            };

            const handleLogout = () => {
                setIsAdmin(false);
                setIsAuthenticated(false);
                localStorage.removeItem('tt_is_admin');
                showAlert('–ò–∑–ª—è–∑–æ—Ö—Ç–µ –æ—Ç —Å–∏—Å—Ç–µ–º–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ!');
            };

            const enterAsGuest = () => {
                setIsAuthenticated(true);
                setIsAdmin(false);
                setShowLogin(false);
            };

            // Player CRUD
            const addOrUpdatePlayer = () => {
                if (!playerForm.firstName || !playerForm.lastName || !playerForm.dateOfBirth) {
                    showAlert('–ú–æ–ª—è –ø–æ–ø—ä–ª–Ω–µ—Ç–µ –≤—Å–∏—á–∫–∏ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–µ—Ç–∞!', 'error');
                    return;
                }

                const ageGroup = getAgeGroup(playerForm.dateOfBirth, playerForm.gender);
                
                if (editingPlayer) {
                    setPlayers(players.map(p => 
                        p.id === editingPlayer.id 
                            ? { ...p, ...playerForm, ageGroup, currentPoints: p.currentPoints }
                            : p
                    ));
                    showAlert('–°—ä—Å—Ç–µ–∑–∞—Ç–µ–ª—è—Ç –µ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ!');
                    setEditingPlayer(null);
                } else {
                    const newPlayer = {
                        id: generateId(),
                        ...playerForm,
                        ageGroup,
                        currentPoints: parseFloat(playerForm.initialPoints),
                        monthlyPoints: { [currentMonth]: parseFloat(playerForm.initialPoints) }
                    };
                    setPlayers([...players, newPlayer]);
                    showAlert('–°—ä—Å—Ç–µ–∑–∞—Ç–µ–ª—è—Ç –µ –¥–æ–±–∞–≤–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
                }
                
                setPlayerForm({
                    firstName: '', lastName: '', dateOfBirth: '', gender: '–ú—ä–∂',
                    clubId: '', licenseNumber: '', initialPoints: 500
                });
            };

            const editPlayer = (player) => {
                setPlayerForm({
                    firstName: player.firstName,
                    lastName: player.lastName,
                    dateOfBirth: player.dateOfBirth,
                    gender: player.gender,
                    clubId: player.clubId,
                    licenseNumber: player.licenseNumber,
                    initialPoints: player.initialPoints
                });
                setEditingPlayer(player);
                setActiveTab('players');
            };

            const deletePlayer = (id) => {
                if (window.confirm('–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ —Ç–æ–∑–∏ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª?')) {
                    setPlayers(players.filter(p => p.id !== id));
                    showAlert('–°—ä—Å—Ç–µ–∑–∞—Ç–µ–ª—è—Ç –µ –∏–∑—Ç—Ä–∏—Ç —É—Å–ø–µ—à–Ω–æ!');
                }
            };

            // Club CRUD
            const addOrUpdateClub = () => {
                if (!clubForm.name || !clubForm.city) {
                    showAlert('–ú–æ–ª—è –ø–æ–ø—ä–ª–Ω–µ—Ç–µ –≤—Å–∏—á–∫–∏ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–µ—Ç–∞!', 'error');
                    return;
                }

                if (editingClub) {
                    setClubs(clubs.map(c => 
                        c.id === editingClub.id ? { ...c, ...clubForm } : c
                    ));
                    showAlert('–ö–ª—É–±—ä—Ç –µ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ!');
                    setEditingClub(null);
                } else {
                    const newClub = { id: generateId(), ...clubForm };
                    setClubs([...clubs, newClub]);
                    showAlert('–ö–ª—É–±—ä—Ç –µ –¥–æ–±–∞–≤–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
                }
                
                setClubForm({ name: '', city: '', clubNumber: '' });
            };

            const editClub = (club) => {
                setClubForm({
                    name: club.name,
                    city: club.city,
                    clubNumber: club.clubNumber
                });
                setEditingClub(club);
                setActiveTab('clubs');
            };

            const deleteClub = (id) => {
                if (window.confirm('–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ —Ç–æ–∑–∏ –∫–ª—É–±?')) {
                    setClubs(clubs.filter(c => c.id !== id));
                    showAlert('–ö–ª—É–±—ä—Ç –µ –∏–∑—Ç—Ä–∏—Ç —É—Å–ø–µ—à–Ω–æ!');
                }
            };

            // Tournament CRUD
            const addOrUpdateTournament = () => {
                if (!tournamentForm.name || !tournamentForm.startDate) {
                    showAlert('–ú–æ–ª—è –ø–æ–ø—ä–ª–Ω–µ—Ç–µ –≤—Å–∏—á–∫–∏ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–µ—Ç–∞!', 'error');
                    return;
                }

                if (editingTournament) {
                    setTournaments(tournaments.map(t => 
                        t.id === editingTournament.id ? { ...t, ...tournamentForm } : t
                    ));
                    showAlert('–¢—É—Ä–Ω–∏—Ä—ä—Ç –µ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ!');
                    setEditingTournament(null);
                } else {
                    const newTournament = { id: generateId(), ...tournamentForm };
                    setTournaments([...tournaments, newTournament]);
                    showAlert('–¢—É—Ä–Ω–∏—Ä—ä—Ç –µ –¥–æ–±–∞–≤–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
                }
                
                setTournamentForm({
                    name: '', startDate: '', endDate: '', location: '', hostClubId: '', coefficient: 1.0
                });
            };

            const editTournament = (tournament) => {
                setTournamentForm({
                    name: tournament.name,
                    startDate: tournament.startDate,
                    endDate: tournament.endDate,
                    location: tournament.location,
                    hostClubId: tournament.hostClubId,
                    coefficient: tournament.coefficient
                });
                setEditingTournament(tournament);
                setActiveTab('tournaments');
            };

            const deleteTournament = (id) => {
                if (window.confirm('–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ —Ç–æ–∑–∏ —Ç—É—Ä–Ω–∏—Ä?')) {
                    setTournaments(tournaments.filter(t => t.id !== id));
                    showAlert('–¢—É—Ä–Ω–∏—Ä—ä—Ç –µ –∏–∑—Ç—Ä–∏—Ç —É—Å–ø–µ—à–Ω–æ!');
                }
            };

            // Match handling
            const addMatch = () => {
                if (!matchForm.tournamentId || !matchForm.player1Id || !matchForm.player2Id || !matchForm.winnerId) {
                    showAlert('–ú–æ–ª—è –ø–æ–ø—ä–ª–Ω–µ—Ç–µ –≤—Å–∏—á–∫–∏ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–µ—Ç–∞!', 'error');
                    return;
                }

                if (matchForm.player1Id === matchForm.player2Id) {
                    showAlert('–ù–µ –º–æ–∂–µ –¥–∞ –∏–∑–±–µ—Ä–µ—Ç–µ –µ–¥–∏–Ω –∏ —Å—ä—â–∏ –∏–≥—Ä–∞—á!', 'error');
                    return;
                }

                const player1 = players.find(p => p.id === matchForm.player1Id);
                const player2 = players.find(p => p.id === matchForm.player2Id);
                const tournament = tournaments.find(t => t.id === matchForm.tournamentId);
                
                const winner = matchForm.winnerId === player1.id ? player1 : player2;
                const loser = matchForm.winnerId === player1.id ? player2 : player1;
                
                const isWinnerStronger = winner.currentPoints >= loser.currentPoints;
                const pointsChange = calculatePointsChange(
                    winner.currentPoints, 
                    loser.currentPoints, 
                    isWinnerStronger
                );
                
                // Apply tournament coefficient
                const coefficient = parseFloat(tournament.coefficient) || 1.0;
                const finalWinnerChange = pointsChange.winner * coefficient;
                const finalLoserChange = pointsChange.loser * coefficient;

                // Update player points
                setPlayers(players.map(p => {
                    if (p.id === winner.id) {
                        return {
                            ...p,
                            currentPoints: p.currentPoints + finalWinnerChange,
                            monthlyPoints: {
                                ...p.monthlyPoints,
                                [currentMonth]: (p.monthlyPoints?.[currentMonth] || p.currentPoints) + finalWinnerChange
                            }
                        };
                    }
                    if (p.id === loser.id) {
                        return {
                            ...p,
                            currentPoints: Math.max(0, p.currentPoints + finalLoserChange),
                            monthlyPoints: {
                                ...p.monthlyPoints,
                                [currentMonth]: Math.max(0, (p.monthlyPoints?.[currentMonth] || p.currentPoints) + finalLoserChange)
                            }
                        };
                    }
                    return p;
                }));

                const newMatch = {
                    id: generateId(),
                    ...matchForm,
                    date: new Date().toISOString(),
                    month: currentMonth,
                    pointsChange: {
                        [winner.id]: finalWinnerChange,
                        [loser.id]: finalLoserChange
                    }
                };

                setMatches([...matches, newMatch]);
                showAlert('–ú–∞—á—ä—Ç –µ –¥–æ–±–∞–≤–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
                
                setMatchForm({
                    tournamentId: '', player1Id: '', player2Id: '', 
                    format: 'best-of-5', winnerId: '', score: ''
                });
            };

            const deleteMatch = (matchId) => {
                if (window.confirm('–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ —Ç–æ–∑–∏ –º–∞—á? –¢–æ—á–∫–∏—Ç–µ —â–µ –±—ä–¥–∞—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏.')) {
                    const match = matches.find(m => m.id === matchId);
                    
                    // Reverse points changes
                    setPlayers(players.map(p => {
                        if (match.pointsChange[p.id] !== undefined) {
                            return {
                                ...p,
                                currentPoints: p.currentPoints - match.pointsChange[p.id],
                                monthlyPoints: {
                                    ...p.monthlyPoints,
                                    [match.month]: (p.monthlyPoints?.[match.month] || p.currentPoints) - match.pointsChange[p.id]
                                }
                            };
                        }
                        return p;
                    }));

                    setMatches(matches.filter(m => m.id !== matchId));
                    showAlert('–ú–∞—á—ä—Ç –µ –∏–∑—Ç—Ä–∏—Ç —É—Å–ø–µ—à–Ω–æ!');
                }
            };

            // Month navigation
            const changeMonth = (direction) => {
                const [year, month] = currentMonth.split('-').map(Number);
                const date = new Date(year, month - 1);
                date.setMonth(date.getMonth() + direction);
                setCurrentMonth(`${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`);
            };

            const startNewMonth = () => {
                if (window.confirm('–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ —Å—Ç–∞—Ä—Ç–∏—Ä–∞—Ç–µ –Ω–æ–≤ –º–µ—Å–µ—Ü? –¢–µ–∫—É—â–∏—Ç–µ —Ç–æ—á–∫–∏ —â–µ –±—ä–¥–∞—Ç –∑–∞–ø–∞–∑–µ–Ω–∏ –≤ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞.')) {
                    const newMonth = getCurrentMonth();
                    
                    // Save current rankings
                    const currentRankings = {};
                    players.forEach(p => {
                        currentRankings[p.id] = p.currentPoints;
                    });
                    
                    setMonthlyRankings({
                        ...monthlyRankings,
                        [currentMonth]: currentRankings
                    });
                    
                    // Update players for new month
                    setPlayers(players.map(p => ({
                        ...p,
                        monthlyPoints: {
                            ...p.monthlyPoints,
                            [newMonth]: p.currentPoints
                        }
                    })));
                    
                    setCurrentMonth(newMonth);
                    showAlert('–ù–æ–≤–∏—è—Ç –º–µ—Å–µ—Ü –µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ!');
                }
            };

            // Filtered and sorted ranking
            const rankedPlayers = useMemo(() => {
                let filtered = [...players];
                
                // Apply filters
                if (searchTerm) {
                    filtered = filtered.filter(p => 
                        p.firstName.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        p.lastName.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                }
                
                if (filterClub) {
                    filtered = filtered.filter(p => p.clubId === filterClub);
                }
                
                if (filterAgeGroup) {
                    filtered = filtered.filter(p => p.ageGroup === filterAgeGroup);
                }
                
                // Sort by points
                filtered.sort((a, b) => b.currentPoints - a.currentPoints);
                
                return filtered;
            }, [players, searchTerm, filterClub, filterAgeGroup]);

            // Get unique age groups
            const ageGroups = [...new Set(players.map(p => p.ageGroup))];

            // Export functions
            const exportToJSON = () => {
                const data = {
                    players,
                    clubs,
                    tournaments,
                    matches,
                    monthlyRankings,
                    exportDate: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `tt-ranking-${currentMonth}.json`;
                a.click();
                showAlert('–î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–∏ —É—Å–ø–µ—à–Ω–æ!');
            };

            const importFromJSON = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            if (window.confirm('–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–∞—Ç–µ –¥–∞–Ω–Ω–∏? –¢–æ–≤–∞ —â–µ –∑–∞–º–µ–Ω–∏ —Ç–µ–∫—É—â–∏—Ç–µ –¥–∞–Ω–Ω–∏.')) {
                                setPlayers(data.players || []);
                                setClubs(data.clubs || []);
                                setTournaments(data.tournaments || []);
                                setMatches(data.matches || []);
                                setMonthlyRankings(data.monthlyRankings || {});
                                showAlert('–î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–∞–Ω–∏ —É—Å–ø–µ—à–Ω–æ!');
                            }
                        } catch (error) {
                            showAlert('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏!', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };

            return (
                <div className="container">
                    {showLogin && (
                        <div className="login-overlay">
                            <div className="login-modal">
                                <h2>üîê –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞</h2>
                                <p>–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞—à–∏—Ç–µ –¥–∞–Ω–Ω–∏ –∑–∞ –≤—Ö–æ–¥ –∫–∞—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</p>
                                <div className="form-group">
                                    <label>–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ</label>
                                    <input
                                        type="text"
                                        value={loginForm.username}
                                        onChange={(e) => setLoginForm({...loginForm, username: e.target.value})}
                                        placeholder="admin"
                                        onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                    />
                                </div>
                                <div className="form-group">
                                    <label>–ü–∞—Ä–æ–ª–∞</label>
                                    <input
                                        type="password"
                                        value={loginForm.password}
                                        onChange={(e) => setLoginForm({...loginForm, password: e.target.value})}
                                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                        onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                    />
                                </div>
                                <div className="login-buttons">
                                    <button className="btn btn-primary" onClick={handleLogin}>
                                        –í—Ö–æ–¥ –∫–∞—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
                                    </button>
                                    <button className="btn btn-secondary" onClick={enterAsGuest}>
                                        –ü—Ä–æ–¥—ä–ª–∂–∏ –∫–∞—Ç–æ –≥–æ—Å—Ç
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="header header-container">
                        <h1>üèì –†–∞–Ω–≥–ª–∏—Å—Ç–∞ –¢–µ–Ω–∏—Å –Ω–∞ –ú–∞—Å–∞</h1>
                        <p>–°–∏—Å—Ç–µ–º–∞ –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ä–∞–Ω–≥–ª–∏—Å—Ç–∞ –∏ —Ç—É—Ä–Ω–∏—Ä–∏</p>
                        <div className="header-actions">
                            {!isAuthenticated ? (
                                <button className="btn btn-primary" onClick={() => setShowLogin(true)}>
                                    –í—Ö–æ–¥
                                </button>
                            ) : (
                                <>
                                    {isAdmin ? (
                                        <>
                                            <span className="welcome-text">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                                            <span className="admin-badge">ADMIN</span>
                                            <button className="btn btn-secondary" onClick={handleLogout}>
                                                –ò–∑—Ö–æ–¥
                                            </button>
                                        </>
                                    ) : (
                                        <>
                                            <span className="welcome-text">–ì–æ—Å—Ç —Ä–µ–∂–∏–º</span>
                                            <span className="guest-badge">–ì–û–°–¢</span>
                                            <button className="btn btn-primary" onClick={() => setShowLogin(true)}>
                                                –í—Ö–æ–¥ –∫–∞—Ç–æ –∞–¥–º–∏–Ω
                                            </button>
                                        </>
                                    )}
                                </>
                            )}
                        </div>
                    </div>

                    {alert && (
                        <div className={`alert ${alert.type === 'success' ? 'alert-success' : 'alert-error'}`}>
                            {alert.message}
                        </div>
                    )}

                    <div className="nav-tabs">
                        <button className={`nav-tab ${activeTab === 'ranking' ? 'active' : ''}`} 
                                onClick={() => setActiveTab('ranking')}>
                            –†–∞–Ω–≥–ª–∏—Å—Ç–∞
                        </button>
                        {isAdmin && (
                            <button className={`nav-tab ${activeTab === 'players' ? 'active' : ''}`} 
                                    onClick={() => setActiveTab('players')}>
                                –°—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–∏
                            </button>
                        )}
                        {isAdmin && (
                            <button className={`nav-tab ${activeTab === 'clubs' ? 'active' : ''}`} 
                                    onClick={() => setActiveTab('clubs')}>
                                –ö–ª—É–±–æ–≤–µ
                            </button>
                        )}
                        <button className={`nav-tab ${activeTab === 'tournaments' ? 'active' : ''}`} 
                                onClick={() => setActiveTab('tournaments')}>
                            –¢—É—Ä–Ω–∏—Ä–∏
                        </button>
                        <button className={`nav-tab ${activeTab === 'matches' ? 'active' : ''}`} 
                                onClick={() => setActiveTab('matches')}>
                            –ú–∞—á–æ–≤–µ
                        </button>
                        <button className={`nav-tab ${activeTab === 'history' ? 'active' : ''}`} 
                                onClick={() => setActiveTab('history')}>
                            –ò—Å—Ç–æ—Ä–∏—è
                        </button>
                    </div>

                    <div className="content">
                        {activeTab === 'ranking' && (
                            <div>
                                {isAdmin && (
                                    <div className="month-selector">
                                        <button className="btn btn-secondary" onClick={() => changeMonth(-1)}>
                                            ‚Üê –ü—Ä–µ–¥–∏—à–µ–Ω –º–µ—Å–µ—Ü
                                        </button>
                                        <h2 style={{flex: 1, textAlign: 'center'}}>
                                            –†–∞–Ω–≥–ª–∏—Å—Ç–∞ –∑–∞ {currentMonth}
                                        </h2>
                                        <button className="btn btn-secondary" onClick={() => changeMonth(1)}>
                                            –°–ª–µ–¥–≤–∞—â –º–µ—Å–µ—Ü ‚Üí
                                        </button>
                                        <button className="btn btn-success" onClick={startNewMonth}>
                                            –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –Ω–æ–≤ –º–µ—Å–µ—Ü
                                        </button>
                                    </div>
                                )}
                                
                                {!isAdmin && (
                                    <div style={{textAlign: 'center', marginBottom: '20px'}}>
                                        <h2>–†–∞–Ω–≥–ª–∏—Å—Ç–∞ –∑–∞ {currentMonth}</h2>
                                    </div>
                                )}

                                <div className="stats-grid">
                                    <div className="stat-card">
                                        <h4>–û–±—â–æ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–∏</h4>
                                        <p>{players.length}</p>
                                    </div>
                                    <div className="stat-card">
                                        <h4>–û–±—â–æ –∫–ª—É–±–æ–≤–µ</h4>
                                        <p>{clubs.length}</p>
                                    </div>
                                    <div className="stat-card">
                                        <h4>–û–±—â–æ —Ç—É—Ä–Ω–∏—Ä–∏</h4>
                                        <p>{tournaments.length}</p>
                                    </div>
                                    <div className="stat-card">
                                        <h4>–û–±—â–æ –º–∞—á–æ–≤–µ</h4>
                                        <p>{matches.length}</p>
                                    </div>
                                </div>

                                <div className="search-filter">
                                    <div className="form-group">
                                        <label>–¢—ä—Ä—Å–µ–Ω–µ –ø–æ –∏–º–µ</label>
                                        <input
                                            type="text"
                                            placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –∏–º–µ –∏–ª–∏ —Ñ–∞–º–∏–ª–∏—è..."
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>–§–∏–ª—Ç—ä—Ä –ø–æ –∫–ª—É–±</label>
                                        <select value={filterClub} onChange={(e) => setFilterClub(e.target.value)}>
                                            <option value="">–í—Å–∏—á–∫–∏ –∫–ª—É–±–æ–≤–µ</option>
                                            {clubs.map(club => (
                                                <option key={club.id} value={club.id}>{club.name}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>–§–∏–ª—Ç—ä—Ä –ø–æ –≤—ä–∑—Ä–∞—Å—Ç–æ–≤–∞ –≥—Ä—É–ø–∞</label>
                                        <select value={filterAgeGroup} onChange={(e) => setFilterAgeGroup(e.target.value)}>
                                            <option value="">–í—Å–∏—á–∫–∏ –≥—Ä—É–ø–∏</option>
                                            {ageGroups.map(group => (
                                                <option key={group} value={group}>{group}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>&nbsp;</label>
                                        <button className="btn btn-secondary" onClick={() => {
                                            setSearchTerm('');
                                            setFilterClub('');
                                            setFilterAgeGroup('');
                                        }}>
                                            –ò–∑—á–∏—Å—Ç–∏ —Ñ–∏–ª—Ç—Ä–∏—Ç–µ
                                        </button>
                                    </div>
                                </div>

                                <div className="table-container">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>–ü–æ–∑–∏—Ü–∏—è</th>
                                                <th>–ò–º–µ</th>
                                                <th>–§–∞–º–∏–ª–∏—è</th>
                                                <th>–í—ä–∑—Ä–∞—Å—Ç–æ–≤–∞ –≥—Ä—É–ø–∞</th>
                                                <th>–ö–ª—É–±</th>
                                                <th>–¢–æ—á–∫–∏</th>
                                                <th>–õ–∏—Ü–µ–Ω–∑ ‚Ññ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {rankedPlayers.map((player, index) => {
                                                const club = clubs.find(c => c.id === player.clubId);
                                                let positionClass = 'ranking-position';
                                                if (index === 0) positionClass += ' ranking-gold';
                                                else if (index === 1) positionClass += ' ranking-silver';
                                                else if (index === 2) positionClass += ' ranking-bronze';
                                                
                                                return (
                                                    <tr key={player.id}>
                                                        <td className={positionClass}>#{index + 1}</td>
                                                        <td>{player.firstName}</td>
                                                        <td>{player.lastName}</td>
                                                        <td>{player.ageGroup}</td>
                                                        <td>{club ? club.name : '-'}</td>
                                                        <td><strong>{player.currentPoints.toFixed(1)}</strong></td>
                                                        <td>{player.licenseNumber || '-'}</td>
                                                    </tr>
                                                );
                                            })}
                                        </tbody>
                                    </table>
                                </div>

                                {isAdmin && (
                                    <div className="export-section">
                                        <h3>–ï–∫—Å–ø–æ—Ä—Ç / –ò–º–ø–æ—Ä—Ç</h3>
                                        <button className="btn btn-primary" onClick={exportToJSON}>
                                            –ï–∫—Å–ø–æ—Ä—Ç –≤ JSON
                                        </button>
                                        <label className="btn btn-secondary" style={{display: 'inline-block', cursor: 'pointer'}}>
                                            –ò–º–ø–æ—Ä—Ç –æ—Ç JSON
                                            <input type="file" accept=".json" onChange={importFromJSON} style={{display: 'none'}} />
                                        </label>
                                        <button className="btn btn-success" onClick={() => {
                                            const autoBackup = localStorage.getItem('tt_auto_backup');
                                            const backupTimestamp = localStorage.getItem('tt_backup_timestamp');
                                            
                                            if (autoBackup) {
                                                const backup = JSON.parse(autoBackup);
                                                const backupDate = backupTimestamp ? new Date(backupTimestamp).toLocaleString('bg-BG') : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ –¥–∞—Ç–∞';
                                                
                                                if (window.confirm(`–©–µ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—è backup (${backupDate}).\n\n–¢–æ–≤–∞ —â–µ –ø—Ä–µ–∑–∞–ø–∏—à–µ —Ç–µ–∫—É—â–∏—Ç–µ –¥–∞–Ω–Ω–∏!\n\n–ü—Ä–æ–¥—ä–ª–∂–µ—Ç–µ?`)) {
                                                    setPlayers(backup.players || []);
                                                    setClubs(backup.clubs || []);
                                                    setTournaments(backup.tournaments || []);
                                                    setMatches(backup.matches || []);
                                                    setMonthlyRankings(backup.monthlyRankings || {});
                                                    showAlert('–î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏ –æ—Ç backup!');
                                                }
                                            } else {
                                                showAlert('–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω backup!', 'error');
                                            }
                                        }}>
                                            –í—ä–∑—Å—Ç–∞–Ω–æ–≤–∏ –æ—Ç Backup
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}

                        {activeTab === 'players' && (
                            <div>
                                <div className="card">
                                    <h3>{editingPlayer ? '–†–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª' : '–î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –Ω–æ–≤ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª'}</h3>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>–ò–º–µ *</label>
                                            <input
                                                type="text"
                                                value={playerForm.firstName}
                                                onChange={(e) => setPlayerForm({...playerForm, firstName: e.target.value})}
                                                placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –∏–º–µ"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>–§–∞–º–∏–ª–∏—è *</label>
                                            <input
                                                type="text"
                                                value={playerForm.lastName}
                                                onChange={(e) => setPlayerForm({...playerForm, lastName: e.target.value})}
                                                placeholder="–í—ä–≤–µ–¥–µ—Ç–µ —Ñ–∞–º–∏–ª–∏—è"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>–î–∞—Ç–∞ –Ω–∞ —Ä–∞–∂–¥–∞–Ω–µ *</label>
                                            <input
                                                type="date"
                                                value={playerForm.dateOfBirth}
                                                onChange={(e) => setPlayerForm({...playerForm, dateOfBirth: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>–ü–æ–ª</label>
                                            <select
                                                value={playerForm.gender}
                                                onChange={(e) => setPlayerForm({...playerForm, gender: e.target.value})}
                                            >
                                                <option value="–ú—ä–∂">–ú—ä–∂</option>
                                                <option value="–ñ–µ–Ω–∞">–ñ–µ–Ω–∞</option>
                                            </select>
                                        </div>
                                        <div className="form-group">
                                            <label>–í—ä–∑—Ä–∞—Å—Ç–æ–≤–∞ –≥—Ä—É–ø–∞</label>
                                            <input
                                                type="text"
                                                value={playerForm.dateOfBirth && playerForm.gender ? getAgeGroup(playerForm.dateOfBirth, playerForm.gender) : ''}
                                                disabled
                                                style={{background: '#f0f0f0', cursor: 'not-allowed'}}
                                                placeholder="–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–ª–µ–¥ –≤—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –¥–∞—Ç–∞"
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>–ö–ª—É–±</label>
                                            <select
                                                value={playerForm.clubId}
                                                onChange={(e) => setPlayerForm({...playerForm, clubId: e.target.value})}
                                            >
                                                <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ –∫–ª—É–±</option>
                                                {clubs.map(club => (
                                                    <option key={club.id} value={club.id}>{club.name}</option>
                                                ))}
                                            </select>
                                        </div>
                                        <div className="form-group">
                                            <label>–ù–æ–º–µ—Ä –Ω–∞ –ª–∏—Ü–µ–Ω–∑</label>
                                            <input
                                                type="text"
                                                value={playerForm.licenseNumber}
                                                onChange={(e) => setPlayerForm({...playerForm, licenseNumber: e.target.value})}
                                                placeholder="–ù–æ–º–µ—Ä –Ω–∞ –∫–∞—Ä—Ç–æ—Ç–µ–∫–∞"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>–ù–∞—á–∞–ª–Ω–∏ —Ç–æ—á–∫–∏</label>
                                            <input
                                                type="number"
                                                value={playerForm.initialPoints}
                                                onChange={(e) => setPlayerForm({...playerForm, initialPoints: e.target.value})}
                                                placeholder="500"
                                            />
                                        </div>
                                    </div>
                                    <button className="btn btn-primary" onClick={addOrUpdatePlayer}>
                                        {editingPlayer ? '–ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–π —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª' : '–î–æ–±–∞–≤–∏ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª'}
                                    </button>
                                    {editingPlayer && (
                                        <button className="btn btn-secondary" onClick={() => {
                                            setEditingPlayer(null);
                                            setPlayerForm({
                                                firstName: '', lastName: '', dateOfBirth: '', gender: '–ú—ä–∂',
                                                clubId: '', licenseNumber: '', initialPoints: 500
                                            });
                                        }}>
                                            –û—Ç–∫–∞–∂–∏
                                        </button>
                                    )}
                                </div>

                                <div className="card">
                                    <h3>–°–ø–∏—Å—ä–∫ –Ω–∞ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–∏—Ç–µ</h3>
                                    <div className="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>–ò–º–µ</th>
                                                    <th>–§–∞–º–∏–ª–∏—è</th>
                                                    <th>–ü–æ–ª</th>
                                                    <th>–í—ä–∑—Ä–∞—Å—Ç–æ–≤–∞ –≥—Ä—É–ø–∞</th>
                                                    <th>–ö–ª—É–±</th>
                                                    <th>–¢–æ—á–∫–∏</th>
                                                    <th>–õ–∏—Ü–µ–Ω–∑ ‚Ññ</th>
                                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {players.map(player => {
                                                    const club = clubs.find(c => c.id === player.clubId);
                                                    return (
                                                        <tr key={player.id}>
                                                            <td>{player.firstName}</td>
                                                            <td>{player.lastName}</td>
                                                            <td>{player.gender}</td>
                                                            <td>{player.ageGroup}</td>
                                                            <td>{club ? club.name : '-'}</td>
                                                            <td>{player.currentPoints.toFixed(1)}</td>
                                                            <td>{player.licenseNumber || '-'}</td>
                                                            <td>
                                                                <div className="action-buttons">
                                                                    <button className="btn btn-sm btn-primary" onClick={() => editPlayer(player)}>
                                                                        –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π
                                                                    </button>
                                                                    <button className="btn btn-sm btn-danger" onClick={() => deletePlayer(player.id)}>
                                                                        –ò–∑—Ç—Ä–∏–π
                                                                    </button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'clubs' && (
                            <div>
                                <div className="card">
                                    <h3>{editingClub ? '–†–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –∫–ª—É–±' : '–î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –Ω–æ–≤ –∫–ª—É–±'}</h3>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>–ò–º–µ –Ω–∞ –∫–ª—É–±–∞ *</label>
                                            <input
                                                type="text"
                                                value={clubForm.name}
                                                onChange={(e) => setClubForm({...clubForm, name: e.target.value})}
                                                placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –∏–º–µ –Ω–∞ –∫–ª—É–±–∞"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>–ì—Ä–∞–¥ *</label>
                                            <input
                                                type="text"
                                                value={clubForm.city}
                                                onChange={(e) => setClubForm({...clubForm, city: e.target.value})}
                                                placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –≥—Ä–∞–¥"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>–ù–æ–º–µ—Ä –Ω–∞ –∫–ª—É–±–∞</label>
                                            <input
                                                type="text"
                                                value={clubForm.clubNumber}
                                                onChange={(e) => setClubForm({...clubForm, clubNumber: e.target.value})}
                                                placeholder="–ù–æ–º–µ—Ä –Ω–∞ –∫–∞—Ä—Ç–æ—Ç–µ–∫–∞"
                                            />
                                        </div>
                                    </div>
                                    <button className="btn btn-primary" onClick={addOrUpdateClub}>
                                        {editingClub ? '–ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–π –∫–ª—É–±' : '–î–æ–±–∞–≤–∏ –∫–ª—É–±'}
                                    </button>
                                    {editingClub && (
                                        <button className="btn btn-secondary" onClick={() => {
                                            setEditingClub(null);
                                            setClubForm({ name: '', city: '', clubNumber: '' });
                                        }}>
                                            –û—Ç–∫–∞–∂–∏
                                        </button>
                                    )}
                                </div>

                                <div className="card">
                                    <h3>–°–ø–∏—Å—ä–∫ –Ω–∞ –∫–ª—É–±–æ–≤–µ—Ç–µ</h3>
                                    <div className="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>–ò–º–µ –Ω–∞ –∫–ª—É–±–∞</th>
                                                    <th>–ì—Ä–∞–¥</th>
                                                    <th>–ù–æ–º–µ—Ä –Ω–∞ –∫–ª—É–±–∞</th>
                                                    <th>–ë—Ä–æ–π —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–∏</th>
                                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {clubs.map(club => {
                                                    const playerCount = players.filter(p => p.clubId === club.id).length;
                                                    return (
                                                        <tr key={club.id}>
                                                            <td>{club.name}</td>
                                                            <td>{club.city}</td>
                                                            <td>{club.clubNumber || '-'}</td>
                                                            <td>{playerCount}</td>
                                                            <td>
                                                                <div className="action-buttons">
                                                                    <button className="btn btn-sm btn-primary" onClick={() => editClub(club)}>
                                                                        –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π
                                                                    </button>
                                                                    <button className="btn btn-sm btn-danger" onClick={() => deleteClub(club.id)}>
                                                                        –ò–∑—Ç—Ä–∏–π
                                                                    </button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'tournaments' && (
                            <div>
                                {isAdmin && (
                                    <div className="card">
                                        <h3>{editingTournament ? '–†–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä' : '–î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –Ω–æ–≤ —Ç—É—Ä–Ω–∏—Ä'}</h3>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label>–ò–º–µ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä–∞ *</label>
                                                <input
                                                    type="text"
                                                    value={tournamentForm.name}
                                                    onChange={(e) => setTournamentForm({...tournamentForm, name: e.target.value})}
                                                    placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –∏–º–µ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä–∞"
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label>–ù–∞—á–∞–ª–Ω–∞ –¥–∞—Ç–∞ *</label>
                                                <input
                                                    type="date"
                                                    value={tournamentForm.startDate}
                                                    onChange={(e) => setTournamentForm({...tournamentForm, startDate: e.target.value})}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label>–ö—Ä–∞–π–Ω–∞ –¥–∞—Ç–∞</label>
                                                <input
                                                    type="date"
                                                    value={tournamentForm.endDate}
                                                    onChange={(e) => setTournamentForm({...tournamentForm, endDate: e.target.value})}
                                                />
                                            </div>
                                        </div>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label>–õ–æ–∫–∞—Ü–∏—è</label>
                                                <input
                                                    type="text"
                                                    value={tournamentForm.location}
                                                    onChange={(e) => setTournamentForm({...tournamentForm, location: e.target.value})}
                                                    placeholder="–ì—Ä–∞–¥ –∏–ª–∏ –∞–¥—Ä–µ—Å"
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label>–ö–ª—É–± –¥–æ–º–∞–∫–∏–Ω</label>
                                                <select
                                                    value={tournamentForm.hostClubId}
                                                    onChange={(e) => setTournamentForm({...tournamentForm, hostClubId: e.target.value})}
                                                >
                                                    <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ –∫–ª—É–±</option>
                                                    {clubs.map(club => (
                                                        <option key={club.id} value={club.id}>{club.name}</option>
                                                    ))}
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label>–ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç (0.5, 0.75, 1.0)</label>
                                                <input
                                                    type="number"
                                                    step="0.25"
                                                    min="0.5"
                                                    max="1.0"
                                                    value={tournamentForm.coefficient}
                                                    onChange={(e) => setTournamentForm({...tournamentForm, coefficient: e.target.value})}
                                                />
                                            </div>
                                        </div>
                                        <button className="btn btn-primary" onClick={addOrUpdateTournament}>
                                            {editingTournament ? '–ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–π —Ç—É—Ä–Ω–∏—Ä' : '–î–æ–±–∞–≤–∏ —Ç—É—Ä–Ω–∏—Ä'}
                                        </button>
                                        {editingTournament && (
                                            <button className="btn btn-secondary" onClick={() => {
                                                setEditingTournament(null);
                                                setTournamentForm({
                                                    name: '', startDate: '', endDate: '', location: '', hostClubId: '', coefficient: 1.0
                                                });
                                            }}>
                                                –û—Ç–∫–∞–∂–∏
                                            </button>
                                        )}
                                    </div>
                                )}

                                <div className="card">
                                    <h3>–°–ø–∏—Å—ä–∫ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä–∏—Ç–µ</h3>
                                    <div className="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>–ò–º–µ</th>
                                                    <th>–ù–∞—á–∞–ª–Ω–∞ –¥–∞—Ç–∞</th>
                                                    <th>–ö—Ä–∞–π–Ω–∞ –¥–∞—Ç–∞</th>
                                                    <th>–õ–æ–∫–∞—Ü–∏—è</th>
                                                    <th>–ö–ª—É–± –¥–æ–º–∞–∫–∏–Ω</th>
                                                    <th>–ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç</th>
                                                    <th>–ú–∞—á–æ–≤–µ</th>
                                                    {isAdmin && <th>–î–µ–π—Å—Ç–≤–∏—è</th>}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {tournaments.map(tournament => {
                                                    const hostClub = clubs.find(c => c.id === tournament.hostClubId);
                                                    const matchCount = matches.filter(m => m.tournamentId === tournament.id).length;
                                                    return (
                                                        <tr key={tournament.id}>
                                                            <td>{tournament.name}</td>
                                                            <td>{tournament.startDate}</td>
                                                            <td>{tournament.endDate || '-'}</td>
                                                            <td>{tournament.location || '-'}</td>
                                                            <td>{hostClub ? hostClub.name : '-'}</td>
                                                            <td>{tournament.coefficient}x</td>
                                                            <td>{matchCount}</td>
                                                            {isAdmin && (
                                                                <td>
                                                                    <div className="action-buttons">
                                                                        <button className="btn btn-sm btn-primary" onClick={() => editTournament(tournament)}>
                                                                            –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π
                                                                        </button>
                                                                        <button className="btn btn-sm btn-danger" onClick={() => deleteTournament(tournament.id)}>
                                                                            –ò–∑—Ç—Ä–∏–π
                                                                        </button>
                                                                    </div>
                                                                </td>
                                                            )}
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'matches' && (
                            <div>
                                {isAdmin && (
                                    <div className="card">
                                        <h3>–î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –Ω–æ–≤ –º–∞—á</h3>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label>–¢—É—Ä–Ω–∏—Ä *</label>
                                                <select
                                                    value={matchForm.tournamentId}
                                                    onChange={(e) => setMatchForm({...matchForm, tournamentId: e.target.value})}
                                                >
                                                    <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ —Ç—É—Ä–Ω–∏—Ä</option>
                                                    {tournaments.map(tournament => (
                                                        <option key={tournament.id} value={tournament.id}>{tournament.name}</option>
                                                    ))}
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label>–§–æ—Ä–º–∞—Ç</label>
                                                <select
                                                    value={matchForm.format}
                                                    onChange={(e) => setMatchForm({...matchForm, format: e.target.value})}
                                                >
                                                    <option value="best-of-5">Best of 5 (3 –æ—Ç 5)</option>
                                                    <option value="best-of-7">Best of 7 (4 –æ—Ç 7)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label>–ò–≥—Ä–∞—á 1 *</label>
                                                <select
                                                    value={matchForm.player1Id}
                                                    onChange={(e) => setMatchForm({...matchForm, player1Id: e.target.value})}
                                                >
                                                    <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ –∏–≥—Ä–∞—á</option>
                                                    {players.map(player => (
                                                        <option key={player.id} value={player.id}>
                                                            {player.firstName} {player.lastName} ({player.currentPoints.toFixed(1)} —Ç.)
                                                        </option>
                                                    ))}
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label>–ò–≥—Ä–∞—á 2 *</label>
                                                <select
                                                    value={matchForm.player2Id}
                                                    onChange={(e) => setMatchForm({...matchForm, player2Id: e.target.value})}
                                                >
                                                    <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ –∏–≥—Ä–∞—á</option>
                                                    {players.map(player => (
                                                        <option key={player.id} value={player.id}>
                                                            {player.firstName} {player.lastName} ({player.currentPoints.toFixed(1)} —Ç.)
                                                        </option>
                                                    ))}
                                                </select>
                                            </div>
                                        </div>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label>–ü–æ–±–µ–¥–∏—Ç–µ–ª *</label>
                                                <select
                                                    value={matchForm.winnerId}
                                                    onChange={(e) => setMatchForm({...matchForm, winnerId: e.target.value})}
                                                >
                                                    <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª</option>
                                                    {matchForm.player1Id && (
                                                        <option value={matchForm.player1Id}>
                                                            {players.find(p => p.id === matchForm.player1Id)?.firstName} {players.find(p => p.id === matchForm.player1Id)?.lastName}
                                                        </option>
                                                    )}
                                                    {matchForm.player2Id && (
                                                        <option value={matchForm.player2Id}>
                                                            {players.find(p => p.id === matchForm.player2Id)?.firstName} {players.find(p => p.id === matchForm.player2Id)?.lastName}
                                                        </option>
                                                    )}
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label>–†–µ–∑—É–ª—Ç–∞—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä: 3-1, 4-2)</label>
                                                <input
                                                    type="text"
                                                    value={matchForm.score}
                                                    onChange={(e) => setMatchForm({...matchForm, score: e.target.value})}
                                                    placeholder="3-1"
                                                />
                                            </div>
                                        </div>
                                        <button className="btn btn-primary" onClick={addMatch}>
                                            –î–æ–±–∞–≤–∏ –º–∞—á
                                        </button>
                                    </div>
                                )}

                                <div className="card">
                                    <h3>–°–ø–∏—Å—ä–∫ –Ω–∞ –º–∞—á–æ–≤–µ—Ç–µ</h3>
                                    <div className="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>–î–∞—Ç–∞</th>
                                                    <th>–¢—É—Ä–Ω–∏—Ä</th>
                                                    <th>–ò–≥—Ä–∞—á 1</th>
                                                    <th>–ò–≥—Ä–∞—á 2</th>
                                                    <th>–ü–æ–±–µ–¥–∏—Ç–µ–ª</th>
                                                    <th>–†–µ–∑—É–ª—Ç–∞—Ç</th>
                                                    <th>–ü—Ä–æ–º—è–Ω–∞ –≤ —Ç–æ—á–∫–∏—Ç–µ</th>
                                                    {isAdmin && <th>–î–µ–π—Å—Ç–≤–∏—è</th>}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {matches.map(match => {
                                                    const tournament = tournaments.find(t => t.id === match.tournamentId);
                                                    const player1 = players.find(p => p.id === match.player1Id);
                                                    const player2 = players.find(p => p.id === match.player2Id);
                                                    const winner = players.find(p => p.id === match.winnerId);
                                                    
                                                    return (
                                                        <tr key={match.id}>
                                                            <td>{new Date(match.date).toLocaleDateString('bg-BG')}</td>
                                                            <td>{tournament?.name || '-'}</td>
                                                            <td>{player1 ? `${player1.firstName} ${player1.lastName}` : '-'}</td>
                                                            <td>{player2 ? `${player2.firstName} ${player2.lastName}` : '-'}</td>
                                                            <td><strong>{winner ? `${winner.firstName} ${winner.lastName}` : '-'}</strong></td>
                                                            <td>{match.score || '-'}</td>
                                                            <td>
                                                                {player1 && match.pointsChange[player1.id] && (
                                                                    <div className={match.pointsChange[player1.id] > 0 ? 'points-gain' : 'points-loss'}>
                                                                        {player1.firstName}: {match.pointsChange[player1.id] > 0 ? '+' : ''}{match.pointsChange[player1.id].toFixed(1)}
                                                                    </div>
                                                                )}
                                                                {player2 && match.pointsChange[player2.id] && (
                                                                    <div className={match.pointsChange[player2.id] > 0 ? 'points-gain' : 'points-loss'}>
                                                                        {player2.firstName}: {match.pointsChange[player2.id] > 0 ? '+' : ''}{match.pointsChange[player2.id].toFixed(1)}
                                                                    </div>
                                                                )}
                                                            </td>
                                                            {isAdmin && (
                                                                <td>
                                                                    <button className="btn btn-sm btn-danger" onClick={() => deleteMatch(match.id)}>
                                                                        –ò–∑—Ç—Ä–∏–π
                                                                    </button>
                                                                </td>
                                                            )}
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'history' && (
                            <div>
                                <div className="card">
                                    <h3>–ú–µ—Å–µ—á–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ —Ä–∞–Ω–≥–ª–∏—Å—Ç–∞—Ç–∞</h3>
                                    {Object.keys(monthlyRankings).length === 0 ? (
                                        <p>–í—Å–µ –æ—â–µ –Ω—è–º–∞ –∑–∞–ø–∞–∑–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ —Ä–∞–Ω–≥–ª–∏—Å—Ç–∞—Ç–∞. –°—Ç–∞—Ä—Ç–∏—Ä–∞–π—Ç–µ –Ω–æ–≤ –º–µ—Å–µ—Ü, –∑–∞ –¥–∞ –∑–∞–ø–∞–∑–∏—Ç–µ —Ç–µ–∫—É—â–∞—Ç–∞ —Ä–∞–Ω–≥–ª–∏—Å—Ç–∞.</p>
                                    ) : (
                                        Object.entries(monthlyRankings).reverse().map(([month, rankings]) => {
                                            const rankedData = Object.entries(rankings)
                                                .map(([playerId, points]) => ({
                                                    player: players.find(p => p.id === playerId),
                                                    points
                                                }))
                                                .filter(item => item.player)
                                                .sort((a, b) => b.points - a.points);

                                            return (
                                                <div key={month} style={{marginBottom: '30px'}}>
                                                    <h4>–†–∞–Ω–≥–ª–∏—Å—Ç–∞ –∑–∞ {month}</h4>
                                                    <div className="table-container">
                                                        <table>
                                                            <thead>
                                                                <tr>
                                                                    <th>–ü–æ–∑–∏—Ü–∏—è</th>
                                                                    <th>–ò–º–µ</th>
                                                                    <th>–§–∞–º–∏–ª–∏—è</th>
                                                                    <th>–¢–æ—á–∫–∏</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                {rankedData.map((item, index) => (
                                                                    <tr key={item.player.id}>
                                                                        <td className="ranking-position">#{index + 1}</td>
                                                                        <td>{item.player.firstName}</td>
                                                                        <td>{item.player.lastName}</td>
                                                                        <td><strong>{item.points.toFixed(1)}</strong></td>
                                                                    </tr>
                                                                ))}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            );
                                        })
                                    )}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
